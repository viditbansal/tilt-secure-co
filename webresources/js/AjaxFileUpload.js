jQuery.extend({createUploadIframe:function(e,t){var n="jUploadFrame"+e;var r='<iframe id="'+n+'" name="'+n+'" style="position:absolute; top:-9999px; left:-9999px"';if(window.ActiveXObject){if(typeof t=="boolean"){r+=' src="'+"javascript:false"+'"'}else if(typeof t=="string"){r+=' src="'+t+'"'}}r+=" />";jQuery(r).appendTo(document.body);return jQuery("#"+n).get(0)},createUploadForm:function(e,t,n){var r="jUploadForm"+e;var i="jUploadFile"+e;var s=jQuery('<form  action="" method="POST" name="'+r+'" id="'+r+'" enctype="multipart/form-data"></form>');if(n){for(var o in n){jQuery('<input type="hidden" name="'+o+'" value="'+n[o]+'" />').appendTo(s)}}var u=jQuery("#"+t);var a=jQuery(u).clone();jQuery(u).attr("id",i);jQuery(u).before(a);jQuery(u).appendTo(s);jQuery(s).css("position","absolute");jQuery(s).css("top","-1200px");jQuery(s).css("left","-1200px");jQuery(s).appendTo("body");return s},ajaxFileUpload:function(e){e=jQuery.extend({},jQuery.ajaxSettings,e);var t=(new Date).getTime();var n=jQuery.createUploadForm(t,e.fileElementId,typeof e.data=="undefined"?false:e.data);var r=jQuery.createUploadIframe(t,e.secureuri);var i="jUploadFrame"+t;var s="jUploadForm"+t;if(e.global&&!(jQuery.active++)){jQuery.event.trigger("ajaxStart")}var o=false;var u={};if(e.global)jQuery.event.trigger("ajaxSend",[u,e]);var a=function(t){var r=document.getElementById(i);try{if(r.contentWindow){u.responseText=r.contentWindow.document.body?r.contentWindow.document.body.innerHTML:null;u.responseXML=r.contentWindow.document.XMLDocument?r.contentWindow.document.XMLDocument:r.contentWindow.document}else if(r.contentDocument){u.responseText=r.contentDocument.document.body?r.contentDocument.document.body.innerHTML:null;u.responseXML=r.contentDocument.document.XMLDocument?r.contentDocument.document.XMLDocument:r.contentDocument.document}}catch(s){jQuery.handleError(e,u,null,s)}if(u||t=="timeout"){o=true;var a;try{a=t!="timeout"?"success":"error";if(a!="error"){var f=jQuery.uploadHttpData(u,e.dataType);if(e.success)e.success(f,a);if(e.global)jQuery.event.trigger("ajaxSuccess",[u,e])}else jQuery.handleError(e,u,a)}catch(s){a="error";jQuery.handleError(e,u,a,s)}if(e.global)jQuery.event.trigger("ajaxComplete",[u,e]);if(e.global&&!--jQuery.active)jQuery.event.trigger("ajaxStop");if(e.complete)e.complete(u,a);jQuery(r).unbind();setTimeout(function(){try{jQuery(r).remove();jQuery(n).remove()}catch(t){jQuery.handleError(e,u,null,t)}},100);u=null}};if(e.timeout>0){setTimeout(function(){if(!o)a("timeout")},e.timeout)}try{var n=jQuery("#"+s);jQuery(n).attr("action",e.url);jQuery(n).attr("method","POST");jQuery(n).attr("target",i);if(n.encoding){jQuery(n).attr("encoding","multipart/form-data")}else{jQuery(n).attr("enctype","multipart/form-data")}jQuery(n).submit()}catch(f){jQuery.handleError(e,u,null,f)}jQuery("#"+i).load(a);return{abort:function(){}}},uploadHttpData:function(r,type){var data=!type;data=type=="xml"||data?r.responseXML:r.responseText;if(type=="script")jQuery.globalEval(data);if(type=="json")eval("data = "+data);if(type=="html")jQuery("<div>").html(data).evalScripts();return data},handleError:function(e,t,n,r){if(e.error){e.error.call(e.context||window,t,n,r)}if(e.global){(e.context?jQuery(e.context):jQuery.event).trigger("ajaxError",[t,e,r])}}})