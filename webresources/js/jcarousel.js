/*!
 * jCarousel - Riding carousels with jQuery
 *   http://sorgalla.com/jcarousel/
 *
 * Copyright (c) 2006 Jan Sorgalla (http://sorgalla.com)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Built on top of the jQuery library
 *   http://jquery.com
 *
 * Inspired by the "Carousel Component" by Bill Scott
 *   http://billwscott.com/carousel/
 */
(function(e){var t={vertical:!1,rtl:!1,start:1,offset:1,size:null,scroll:1,visible:1,animation:"normal",easing:"swing",auto:0,wrap:null,initCallback:null,setupCallback:null,reloadCallback:null,itemLoadCallback:null,itemFirstInCallback:null,itemFirstOutCallback:null,itemLastInCallback:null,itemLastOutCallback:null,itemVisibleInCallback:null,itemVisibleOutCallback:null,animationStepCallback:null,buttonNextHTML:"<div>Next</div>",buttonPrevHTML:"<div>Prev</div>",buttonNextEvent:"click",buttonPrevEvent:"click",buttonNextCallback:null,buttonPrevCallback:null,itemFallbackDimension:null},n=!1;e(window).bind("load.jcarousel",function(){n=!0}),e.jcarousel=function(i,s){this.options=e.extend({},t,s||{}),this.locked=!1,this.autoStopped=!1,this.container=null,this.clip=null,this.list=null,this.buttonNext=null,this.buttonPrev=null,this.buttonNextState=null,this.buttonPrevState=null,s&&void 0!==s.rtl||(this.options.rtl="rtl"==(e(i).attr("dir")||e("html").attr("dir")||"").toLowerCase()),this.wh=this.options.vertical?"height":"width",this.lt=this.options.vertical?"top":this.options.rtl?"right":"left";for(var o="",u=i.className.split(" "),f=0;u.length>f;f++)if(-1!=u[f].indexOf("jcarousel-skin")){e(i).removeClass(u[f]),o=u[f];break}"UL"==i.nodeName.toUpperCase()||"OL"==i.nodeName.toUpperCase()?(this.list=e(i),this.clip=this.list.parents(".jcarousel-clip"),this.container=this.list.parents(".jcarousel-container")):(this.container=e(i),this.list=this.container.find("ul,ol").eq(0),this.clip=this.container.find(".jcarousel-clip")),0===this.clip.size()&&(this.clip=this.list.wrap("<div></div>").parent()),0===this.container.size()&&(this.container=this.clip.wrap("<div></div>").parent()),""!==o&&-1==this.container.parent()[0].className.indexOf("jcarousel-skin")&&this.container.wrap('<div class=" '+o+'"></div>'),this.buttonPrev=e(".jcarousel-prev",this.container),0===this.buttonPrev.size()&&null!==this.options.buttonPrevHTML&&(this.buttonPrev=e(this.options.buttonPrevHTML).appendTo(this.container)),this.buttonPrev.addClass(this.className("jcarousel-prev")),this.buttonNext=e(".jcarousel-next",this.container),0===this.buttonNext.size()&&null!==this.options.buttonNextHTML&&(this.buttonNext=e(this.options.buttonNextHTML).appendTo(this.container)),this.buttonNext.addClass(this.className("jcarousel-next")),this.clip.addClass(this.className("jcarousel-clip")).css({position:"relative"}),this.list.addClass(this.className("jcarousel-list")).css({overflow:"hidden",position:"relative",top:0,margin:0,padding:0}).css(this.options.rtl?"right":"left",0),this.container.addClass(this.className("jcarousel-container")).css({position:"relative"}),!this.options.vertical&&this.options.rtl&&this.container.addClass("jcarousel-direction-rtl").attr("dir","rtl");var l=null!==this.options.visible?Math.ceil(this.clipping()/this.options.visible):null,h=this.list.children("li"),p=this;if(h.size()>0){var v=0,m=this.options.offset;h.each(function(){p.format(this,m++),v+=p.dimension(this,l)}),this.list.css(this.wh,v+100+"px"),s&&void 0!==s.size||(this.options.size=h.size())}this.container.css("display","block"),this.buttonNext.css("display","block"),this.buttonPrev.css("display","block"),this.funcNext=function(){return p.next(),!1},this.funcPrev=function(){return p.prev(),!1},this.funcResize=function(){p.resizeTimer&&clearTimeout(p.resizeTimer),p.resizeTimer=setTimeout(function(){p.reload()},100)},null!==this.options.initCallback&&this.options.initCallback(this,"init"),!n&&r.isSafari()?(this.buttons(!1,!1),e(window).bind("load.jcarousel",function(){p.setup()})):this.setup()};var r=e.jcarousel;r.fn=r.prototype={jcarousel:"0.2.9"},r.fn.extend=r.extend=e.extend,r.fn.extend({setup:function(){if(this.first=null,this.last=null,this.prevFirst=null,this.prevLast=null,this.animating=!1,this.timer=null,this.resizeTimer=null,this.tail=null,this.inTail=!1,!this.locked){this.list.css(this.lt,this.pos(this.options.offset)+"px");var t=this.pos(this.options.start,!0);this.prevFirst=this.prevLast=null,this.animate(t,!1),e(window).unbind("resize.jcarousel",this.funcResize).bind("resize.jcarousel",this.funcResize),null!==this.options.setupCallback&&this.options.setupCallback(this)}},reset:function(){this.list.empty(),this.list.css(this.lt,"0px"),this.list.css(this.wh,"10px"),null!==this.options.initCallback&&this.options.initCallback(this,"reset"),this.setup()},reload:function(){if(null!==this.tail&&this.inTail&&this.list.css(this.lt,r.intval(this.list.css(this.lt))+this.tail),this.tail=null,this.inTail=!1,null!==this.options.reloadCallback&&this.options.reloadCallback(this),null!==this.options.visible){var e=this,t=Math.ceil(this.clipping()/this.options.visible),n=0,i=0;this.list.children("li").each(function(r){n+=e.dimension(this,t),e.first>r+1&&(i=n)}),this.list.css(this.wh,n+"px"),this.list.css(this.lt,-i+"px")}this.scroll(this.first,!1)},lock:function(){this.locked=!0,this.buttons()},unlock:function(){this.locked=!1,this.buttons()},size:function(e){return void 0!==e&&(this.options.size=e,this.locked||this.buttons()),this.options.size},has:function(e,t){void 0!==t&&t||(t=e),null!==this.options.size&&t>this.options.size&&(t=this.options.size);for(var n=e;t>=n;n++){var r=this.get(n);if(!r.length||r.hasClass("jcarousel-item-placeholder"))return!1}return!0},get:function(t){return e(">.jcarousel-item-"+t,this.list)},add:function(t,n){var i=this.get(t),s=0,o=e(n);if(0===i.length){var u,f=r.intval(t);for(i=this.create(t);;)if(u=this.get(--f),0>=f||u.length){0>=f?this.list.prepend(i):u.after(i);break}}else s=this.dimension(i);"LI"==o.get(0).nodeName.toUpperCase()?(i.replaceWith(o),i=o):i.empty().append(n),this.format(i.removeClass(this.className("jcarousel-item-placeholder")),t);var l=null!==this.options.visible?Math.ceil(this.clipping()/this.options.visible):null,c=this.dimension(i,l)-s;return t>0&&this.first>t&&this.list.css(this.lt,r.intval(this.list.css(this.lt))-c+"px"),this.list.css(this.wh,r.intval(this.list.css(this.wh))+c+"px"),i},remove:function(e){var t=this.get(e);if(t.length&&!(e>=this.first&&this.last>=e)){var n=this.dimension(t);this.first>e&&this.list.css(this.lt,r.intval(this.list.css(this.lt))+n+"px"),t.remove(),this.list.css(this.wh,r.intval(this.list.css(this.wh))-n+"px")}},next:function(){null===this.tail||this.inTail?this.scroll("both"!=this.options.wrap&&"last"!=this.options.wrap||null===this.options.size||this.last!=this.options.size?this.first+this.options.scroll:1):this.scrollTail(!1)},prev:function(){null!==this.tail&&this.inTail?this.scrollTail(!0):this.scroll("both"!=this.options.wrap&&"first"!=this.options.wrap||null===this.options.size||1!=this.first?this.first-this.options.scroll:this.options.size)},scrollTail:function(e){if(!this.locked&&!this.animating&&this.tail){this.pauseAuto();var t=r.intval(this.list.css(this.lt));t=e?t+this.tail:t-this.tail,this.inTail=!e,this.prevFirst=this.first,this.prevLast=this.last,this.animate(t)}},scroll:function(e,t){this.locked||this.animating||(this.pauseAuto(),this.animate(this.pos(e),t))},pos:function(e,t){var n=r.intval(this.list.css(this.lt));if(this.locked||this.animating)return n;"circular"!=this.options.wrap&&(e=1>e?1:this.options.size&&e>this.options.size?this.options.size:e);for(var i,s=this.first>e,o="circular"!=this.options.wrap&&1>=this.first?1:this.first,u=s?this.get(o):this.get(this.last),a=s?o:o-1,f=null,l=0,c=!1,h=0;s?--a>=e:e>++a;)f=this.get(a),c=!f.length,0===f.length&&(f=this.create(a).addClass(this.className("jcarousel-item-placeholder")),u[s?"before":"after"](f),null!==this.first&&"circular"==this.options.wrap&&null!==this.options.size&&(0>=a||a>this.options.size)&&(i=this.get(this.index(a)),i.length&&(f=this.add(a,i.clone(!0))))),u=f,h=this.dimension(f),c&&(l+=h),null!==this.first&&("circular"==this.options.wrap||a>=1&&(null===this.options.size||this.options.size>=a))&&(n=s?n+h:n-h);var p=this.clipping(),v=[],m=0,g=0;for(u=this.get(e-1),a=e;++m;){if(f=this.get(a),c=!f.length,0===f.length&&(f=this.create(a).addClass(this.className("jcarousel-item-placeholder")),0===u.length?this.list.prepend(f):u[s?"before":"after"](f),null!==this.first&&"circular"==this.options.wrap&&null!==this.options.size&&(0>=a||a>this.options.size)&&(i=this.get(this.index(a)),i.length&&(f=this.add(a,i.clone(!0))))),u=f,h=this.dimension(f),0===h)throw Error("jCarousel: No width/height set for items. This will cause an infinite loop. Aborting...");if("circular"!=this.options.wrap&&null!==this.options.size&&a>this.options.size?v.push(f):c&&(l+=h),g+=h,g>=p)break;a++}for(var y=0;v.length>y;y++)v[y].remove();l>0&&(this.list.css(this.wh,this.dimension(this.list)+l+"px"),s&&(n-=l,this.list.css(this.lt,r.intval(this.list.css(this.lt))-l+"px")));var b=e+m-1;if("circular"!=this.options.wrap&&this.options.size&&b>this.options.size&&(b=this.options.size),a>b)for(m=0,a=b,g=0;++m&&(f=this.get(a--),f.length)&&(g+=this.dimension(f),!(g>=p)););var w=b-m+1;if("circular"!=this.options.wrap&&1>w&&(w=1),this.inTail&&s&&(n+=this.tail,this.inTail=!1),this.tail=null,"circular"!=this.options.wrap&&b==this.options.size&&b-m+1>=1){var E=r.intval(this.get(b).css(this.options.vertical?"marginBottom":"marginRight"));g-E>p&&(this.tail=g-p-E)}for(t&&e===this.options.size&&this.tail&&(n-=this.tail,this.inTail=!0);e-->w;)n+=this.dimension(this.get(e));return this.prevFirst=this.first,this.prevLast=this.last,this.first=w,this.last=b,n},animate:function(t,n){if(!this.locked&&!this.animating){this.animating=!0;var r=this,i=function(){if(r.animating=!1,0===t&&r.list.css(r.lt,0),!r.autoStopped&&("circular"==r.options.wrap||"both"==r.options.wrap||"last"==r.options.wrap||null===r.options.size||r.last<r.options.size||r.last==r.options.size&&null!==r.tail&&!r.inTail)&&r.startAuto(),r.buttons(),r.notify("onAfterAnimation"),"circular"==r.options.wrap&&null!==r.options.size)for(var e=r.prevFirst;r.prevLast>=e;e++)null===e||e>=r.first&&r.last>=e||!(1>e||e>r.options.size)||r.remove(e)};if(this.notify("onBeforeAnimation"),this.options.animation&&n!==!1){var s=this.options.vertical?{top:t}:this.options.rtl?{right:t}:{left:t},o={duration:this.options.animation,easing:this.options.easing,complete:i};e.isFunction(this.options.animationStepCallback)&&(o.step=this.options.animationStepCallback),this.list.animate(s,o)}else this.list.css(this.lt,t+"px"),i()}},startAuto:function(e){if(void 0!==e&&(this.options.auto=e),0===this.options.auto)return this.stopAuto();if(null===this.timer){this.autoStopped=!1;var t=this;this.timer=window.setTimeout(function(){t.next()},1e3*this.options.auto)}},stopAuto:function(){this.pauseAuto(),this.autoStopped=!0},pauseAuto:function(){null!==this.timer&&(window.clearTimeout(this.timer),this.timer=null)},buttons:function(e,t){null==e&&(e=!this.locked&&0!==this.options.size&&(this.options.wrap&&"first"!=this.options.wrap||null===this.options.size||this.last<this.options.size),this.locked||this.options.wrap&&"first"!=this.options.wrap||null===this.options.size||!(this.last>=this.options.size)||(e=null!==this.tail&&!this.inTail)),null==t&&(t=!this.locked&&0!==this.options.size&&(this.options.wrap&&"last"!=this.options.wrap||this.first>1),this.locked||this.options.wrap&&"last"!=this.options.wrap||null===this.options.size||1!=this.first||(t=null!==this.tail&&this.inTail));var n=this;this.buttonNext.size()>0?(this.buttonNext.unbind(this.options.buttonNextEvent+".jcarousel",this.funcNext),e&&this.buttonNext.bind(this.options.buttonNextEvent+".jcarousel",this.funcNext),this.buttonNext[e?"removeClass":"addClass"](this.className("jcarousel-next-disabled")).attr("disabled",e?!1:!0),null!==this.options.buttonNextCallback&&this.buttonNext.data("jcarouselstate")!=e&&this.buttonNext.each(function(){n.options.buttonNextCallback(n,this,e)}).data("jcarouselstate",e)):null!==this.options.buttonNextCallback&&this.buttonNextState!=e&&this.options.buttonNextCallback(n,null,e),this.buttonPrev.size()>0?(this.buttonPrev.unbind(this.options.buttonPrevEvent+".jcarousel",this.funcPrev),t&&this.buttonPrev.bind(this.options.buttonPrevEvent+".jcarousel",this.funcPrev),this.buttonPrev[t?"removeClass":"addClass"](this.className("jcarousel-prev-disabled")).attr("disabled",t?!1:!0),null!==this.options.buttonPrevCallback&&this.buttonPrev.data("jcarouselstate")!=t&&this.buttonPrev.each(function(){n.options.buttonPrevCallback(n,this,t)}).data("jcarouselstate",t)):null!==this.options.buttonPrevCallback&&this.buttonPrevState!=t&&this.options.buttonPrevCallback(n,null,t),this.buttonNextState=e,this.buttonPrevState=t},notify:function(e){var t=null===this.prevFirst?"init":this.prevFirst<this.first?"next":"prev";this.callback("itemLoadCallback",e,t),this.prevFirst!==this.first&&(this.callback("itemFirstInCallback",e,t,this.first),this.callback("itemFirstOutCallback",e,t,this.prevFirst)),this.prevLast!==this.last&&(this.callback("itemLastInCallback",e,t,this.last),this.callback("itemLastOutCallback",e,t,this.prevLast)),this.callback("itemVisibleInCallback",e,t,this.first,this.last,this.prevFirst,this.prevLast),this.callback("itemVisibleOutCallback",e,t,this.prevFirst,this.prevLast,this.first,this.last)},callback:function(t,n,r,i,s,o,u){if(null!=this.options[t]&&("object"==typeof this.options[t]||"onAfterAnimation"==n)){var f="object"==typeof this.options[t]?this.options[t][n]:this.options[t];if(e.isFunction(f)){var l=this;if(void 0===i)f(l,r,n);else if(void 0===s)this.get(i).each(function(){f(l,this,i,r,n)});else for(var c=function(e){l.get(e).each(function(){f(l,this,e,r,n)})},h=i;s>=h;h++)null===h||h>=o&&u>=h||c(h)}}},create:function(e){return this.format("<li></li>",e)},format:function(t,n){t=e(t);for(var r=t.get(0).className.split(" "),i=0;r.length>i;i++)-1!=r[i].indexOf("jcarousel-")&&t.removeClass(r[i]);return t.addClass(this.className("jcarousel-item")).addClass(this.className("jcarousel-item-"+n)).css({"float":this.options.rtl?"right":"left","list-style":"none"}).attr("jcarouselindex",n),t},className:function(e){return e+" "+e+(this.options.vertical?"-vertical":"-horizontal")},dimension:function(t,n){var i=e(t);if(null==n)return this.options.vertical?i.innerHeight()+r.intval(i.css("margin-top"))+r.intval(i.css("margin-bottom"))+r.intval(i.css("border-top-width"))+r.intval(i.css("border-bottom-width"))||r.intval(this.options.itemFallbackDimension):i.innerWidth()+r.intval(i.css("margin-left"))+r.intval(i.css("margin-right"))+r.intval(i.css("border-left-width"))+r.intval(i.css("border-right-width"))||r.intval(this.options.itemFallbackDimension);var s=this.options.vertical?n-r.intval(i.css("marginTop"))-r.intval(i.css("marginBottom")):n-r.intval(i.css("marginLeft"))-r.intval(i.css("marginRight"));return e(i).css(this.wh,s+"px"),this.dimension(i)},clipping:function(){return this.options.vertical?this.clip[0].offsetHeight-r.intval(this.clip.css("borderTopWidth"))-r.intval(this.clip.css("borderBottomWidth")):this.clip[0].offsetWidth-r.intval(this.clip.css("borderLeftWidth"))-r.intval(this.clip.css("borderRightWidth"))},index:function(e,t){return null==t&&(t=this.options.size),Math.round(((e-1)/t-Math.floor((e-1)/t))*t)+1}}),r.extend({defaults:function(n){return e.extend(t,n||{})},intval:function(e){return e=parseInt(e,10),isNaN(e)?0:e},windowLoaded:function(){n=!0},isSafari:function(){var e=navigator.userAgent.toLowerCase(),t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||[],n=t[1]||"";return"webkit"===n}}),e.fn.jcarousel=function(t){if("string"==typeof t){var n=e(this).data("jcarousel"),i=Array.prototype.slice.call(arguments,1);return n[t].apply(n,i)}return this.each(function(){var n=e(this).data("jcarousel");n?(t&&e.extend(n.options,t),n.reload()):e(this).data("jcarousel",new r(this,t))})}})(jQuery)